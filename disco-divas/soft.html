<!DOCTYPE HTML>
<!--
	Helios by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
    <title>Disco Divas</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript>
        <link rel="stylesheet" href="assets/css/noscript.css" />
    </noscript>
</head>

<body class="homepage is-preload">
    <div id="page-wrapper">


        <!-- Nav -->
        <nav id="nav">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li>
                    <a href="#">Subsystems</a>
                    <ul>
                        <li><a href="mech.html"">Mechanical</a></li>
                                    <li><a href=" elec.html">Electrical</a></li>
                        <li><a href="firm.html">Firmware</a></li>
                        <li><a href="soft.html">Software</a></li>
                    </ul>
                </li>
                <li><a href="process.html">Process</a></li>
                <li><a href="budget.html">Budget</a></li>
                <li><a href="team.html">The Team</a></li>
            </ul>
        </nav>

    </div>

    <!-- Banner -->
    <section id="banner">
        <header>
            <!-- <h2><strong>Electrical and Firmware Design</strong></h2> -->

        </header>
    </section>

    <!-- Main -->
    <div class="wrapper style2">

        <article id="main" class="container special">
            <a href="#" class="image featured"><img src="images/software_flow.png" alt="" /></a>
            <header>
                <h2><a href="#">Software Design</a></h2>

            </header>
                <p>
                <b>Github repo:</b> <a href="https://github.com/richardli03/record-music-visualizer.git">https://github.com/richardli03/record-music-visualizer.git</a>
                </p>
                <p>
                <b>Dependencies:</b> argparse, json, os, sys, matplotlib, numpy, pandas, librosa, pdb
                </p>
                <p>
                <h3>Getting Frequencies from Song</h3>
                </p>
                <p>
                Once loading the .wav file, we first turned the song into a series of samples using a linspace. Then, we separated it into all of its constituent frequencies by taking the Fast Fourier Transform. Although we originally wanted to use an intelligent audio processing library to do that, it ended up being much easier to (manually) take the FFT. We put all of the data into a Pandas Dataframe with samples (time) along the columns and the frequencies along the rows. The values go from 0 to -100, where 0 is the loudest and -100 means there’s none of that signal (it’s silent).
                </p>
                <p>
                <figure>
                <img src="images/all_freq_data.png" alt="">
                <figcaption>Fig. "all_freq_data" dataframe</figcaption>
                </figure>
                </p>
                <p>
                <h3>Splitting Frequencies and Computing Volumes</h3>
                </p>
                <p>
                We wanted to get three frequency ranges—bass, mid, and treble. We first split the data in half, because the FFT gave us two sets of identical data (symmetric about 0). We then logarithmically split the frequencies into the three groups. Since we were trying to plot volume over time, we took a weighted average of all the frequency signals at a specific time sample to filter out noise (everything lower than -75) and weight real signals. That left us with a volume for each range at each time point we sampled.
                </p>
                <p>
                    <figure>
                        <img src="images/frequency_plot_2.png" alt="">
                        <figcaption>Fig. volumes of frequency buckets over time</figcaption>
                    </figure>
                </p>
                <p>
                <h3>The Record Player Visual</h3>
                </p>
                <p>
                Since we wanted our visualizer to invoke a record player, we made our visualizations round, like a record. We found the deviation of each point from the average of the category, which we used as a zero point. Once we set each category to have a different baseline radius, we were able to plot the changes in volume on a polar graph to get our first visualizations. 
                </p>
                <p>
                    <figure>
                        <img src="images/circular_visual_1.png" alt="" style="width:30%">
                        <img src="images/circular_visual_2.png" alt="" style="width:30%">
                        <figcaption>Fig. first iteration of circular visuals</figcaption>
                    </figure>
                </p>
                <p>
                <h3>Packaging A CSV</h3>
                </p>
                <p>
                At that point we had the positions we wanted each pen to be at different angles on the circle, which correspond to different points in time. We wanted to package that in a format that the firmware team could use. We decided to make a CSV that held the motor position, in the form of positive or negative inches away from the baseline radius for each pen, versus the angle the disk was at. We decided to do it this way because then we could separate the two parts of the flow a little bit and easily intercept it while doing integration.
                </p>
                <p>
                    <figure>
                        <img src="images/position_csv.png" alt="">
                        <figcaption>Fig. example CSV passed to firmware</figcaption>
                    </figure>
                </p>
                <p>
                <h3>Oscillations</h3>
                </p>
                <p>
                A significant amount of thought went into trying to make the visualizations meaningful. At the core of this project, we were trying to convert one form of art into another in a way that still invoked the feelings from the first. At the point we were at, the visualizations were not super interesting. We decided to add in oscillations, because music is often represented in waves and it’s much more dynamic. It brings the feeling of the music much more. 
                </p>
                <p>
                To create the oscillations, we created a point between every two data points we had and defined a baseline oscillation size. If the data points were within some margin of 0, the new points would oscillate at the baseline size (around 0.2 inches). Any changes from there would be plotted as a larger spike or as a lack of oscillation. This process did indeed make the visualizations much more interesting and artistic.
                </p>
                <p>
                    <figure>
                        <img src="images/oscillations_1.png" alt="">
                        <figcaption>Fig. first circular visual with oscillations added in</figcaption>
                    </figure>
                </p>
                <p>
                <h3>Fine Tuning</h3>
                </p>
                <p>
                We wanted to optimize the visualization a bit more. There was an unexpected spike at the beginning and end of the song that was weighing out any other changes in volume over the course of the song. We determined that this was because the beginning and end of a song are quiet, and because the difference there is much larger than the variation in other parts of the song, so you could only see that. We trimmed the beginning and end of the song to solve that. We also did some scaling to make the variations we wanted to see bigger while also leaving enough space between the rings for the pens to not collide. We found that the rate at which we sampled the song had a huge impact on the visual and its quality, so that also took a bit of fine-tuning, which ended up being different for every song.
                </p>
                <p>
                Here are some of the final visuals we got:
                </p>
                <p>
                    <figure>
                        <img src="images/osc_little_night.png" alt="" style="width:31%">
                        <img src="images/osc_love_story.png" alt="" style="width:30%">
                        <img src="images/osc_miz_biz.png" alt="" style="width:30%">
                        <figcaption>Fig. examples of some final visuals</figcaption>
                    </figure>
                </p>
            <!-- everything else in main text goes here-->
        </article>

    </div>

    <!-- Footer -->
    <div id="footer">
        <div class="container">

            <div class="row">
                <div class="col-12">

                    <!-- Copyright -->
                    <div class="copyright">
                        <ul class="menu">
                            <li></li>
                            <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
                        </ul>
                    </div>

                </div>

            </div>
        </div>
    </div>

    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>

</body>

</html>